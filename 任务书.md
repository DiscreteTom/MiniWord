# 等差式黑尘炮 MiniWord 任务书

- 版本号: v1.0
- 编制人员: 吴奕辰 王景辉 张锦程

## 任务目标概述

实现一个简易的文本编辑程序 要求拥有如下功能

1. 新建文件
2. 打开现有文件
3. 文件另存为
4. 关闭程序
5. 保存内容至文件
6. 使用键盘插入单个字符
7. 使用键盘删除单个字符(支持两个方向)
8. 使用鼠标实现复制粘贴操作
9. 使用鼠标实现块操作
10. 查找替换字符串

其中功能1234需要实现若编辑区有未保存内容时提示保存

## 系统配置

主窗口拥有一个MenuBar 含有如下两个Menu

- 文件
- - 新建
- - 打开
- - 保存
- - 另存为
- - 退出
- 编辑
- - 撤销(高级功能)
- - 剪切
- - 复制
- - 粘贴
- - 删除
- - 查找
- - 查找下一个
- - 替换

其余窗口空间为编辑区域 在其内部可以使用键盘鼠标进行文本编辑 具体可以参考windows记事本

## 运行控制

无命令行参数打开程序时默认新建一个空白文本文件

使用此程序打开文件(即拥有一个文件名作为命令行参数)打开时打开指定的文本文件

在新建文件、另存为文件、打开文件、关闭程序时如果编辑区域有未保存内容需要提示保存(Y/N/Cancel)

## 输入输出

可以使用键盘和鼠标进行输入

键盘支持如下操作

- 输入单个数字
- 英文输入法下输入单个英文字符和英文符号
- 中文输入法下输入中文字符串和中文符号
- 使用Backspace键删除光标前字符
- 使用Delete键删除光标后字符
- 按下Return或Enter键实现换行
- 按下Tab键将输入对应数量的空格符

鼠标支持如下操作

- 使用鼠标左键单击编辑区域位置来定位光标
- 按下鼠标右键出现编辑菜单
- 鼠标拖动选中区域
- 在编辑菜单中可以选择复制粘贴删除剪切

输出通过重写窗口重绘函数实现 以画图的形式输出字符

## 可实现的高级功能

撤销

键盘快捷键-Home End等

键盘组合快捷键-复制粘贴等

使用键盘实现块操作 shift+上下左右

支持选择开启是否自动换行